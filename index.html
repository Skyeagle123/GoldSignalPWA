<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#0b1220">
  <title>إشارات الذهب • GoldSignals</title>
  <link rel="icon" href="icons/icon-192.png">
  <style>
    :root{
      --bg:#0b1220; --card:#111827; --line:#1f2937; --muted:#9ca3af; --soft:#334155;
      --good:#10b981; --bad:#ef4444; --warn:#f59e0b; --txt:#e5e7eb;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--txt);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    header{position:sticky;top:0;z-index:5;background:#0b1220cc;border-bottom:1px solid var(--line);backdrop-filter:blur(6px)}
    .bar{max-width:1100px;margin:0 auto;padding:14px 16px;font-weight:700}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 6px 18px rgba(0,0,0,.25)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{border:1px solid var(--soft);background:transparent;color:var(--txt);padding:8px 12px;border-radius:999px;cursor:pointer}
    .pill.active{background:#0e1a31;border-color:#2b3a55}
    label{display:block;margin-bottom:6px;color:var(--muted);font-size:14px}
    input,button{width:100%;padding:10px;border-radius:12px;border:1px solid var(--soft);background:#0b1220;color:var(--txt)}
    button{cursor:pointer}
    h1,h2,h3{margin:0 0 10px 0}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid #273449;padding:10px;text-align:center}
    .muted{color:var(--muted)}
    .good{color:var(--good);font-weight:600}
    .bad{color:var(--bad);font-weight:600}
    .warn{color:var(--warn);font-weight:600}
    .section-title{margin-bottom:6px}
  </style>
</head>
<body>
  <header><div class="bar">GoldSignals • إشارات الذهب</div></header>

  <div class="container">

    <!-- مصدر البيانات + الإطار الزمني -->
    <div class="card">
      <div class="grid">
        <div>
          <label>رابط CSV للأسعار (اختياري):</label>
          <input id="csvInput" placeholder="اتركه فاضي لاستعمال XAUUSD_5min.csv من نفس الريبو">
          <div class="muted" style="margin-top:6px;font-size:12px">
            إذا تركته فاضي سيقرأ تلقائياً من <code>XAUUSD_5min.csv</code>.
          </div>
        </div>
        <div>
          <label>إطار زمني:</label>
          <div class="row">
            <button id="tf5" class="pill active">5 دقائق</button>
            <button id="tf60" class="pill">ساعة</button>
            <button id="tfD" class="pill">يوم</button>
            <button id="runBtn" class="pill" style="margin-inline-start:auto">حساب الإشارات الآن</button>
          </div>
        </div>
      </div>
    </div>

    <!-- السعر الحي + الملخص -->
    <div class="card">
      <h3 class="section-title">السعر الحي</h3>
      <div class="grid">
        <div>
          <div id="livePrice" style="font-size:36px;font-weight:800">—</div>
          <div id="liveTime" class="muted">—</div>
        </div>
        <div>
          <label>الملخّص الآن:</label>
          <div id="summaryText" style="font-size:18px;font-weight:700">—</div>
        </div>
      </div>
    </div>

    <!-- المؤشرات السريعة -->
    <div class="card">
      <h3 class="section-title">جدول المؤشرات</h3>
      <div class="grid">
        <div>RSI: <b id="indRSI">—</b></div>
        <div>MACD: <b id="indMACD">—</b></div>
        <div>EMA سريع: <b id="indEMAF">—</b></div>
        <div>EMA بطيء: <b id="indEMAS">—</b></div>
      </div>

      <!-- إعدادات المؤشرات (قابلة للتعديل) -->
      <div class="grid" style="margin-top:10px">
        <div><label>EMA سريع</label><input id="emaFast" type="number" value="12"></div>
        <div><label>EMA بطيء</label><input id="emaSlow" type="number" value="26"></div>
        <div><label>فترة RSI</label><input id="rsiPeriod" type="number" value="14"></div>

        <!-- ✅ إضافة جديدة فقط: تفعيل الإشارات الدقيقة -->
        <div>
          <label>الإشارات الدقيقة (تجريبية)</label>
          <label style="display:flex;align-items:center;gap:8px">
            <input id="useSmart" type="checkbox"> تفعيل
          </label>
          <div class="muted" style="font-size:12px">تستخدم اتّجاه أعلى (1س/يومي) + ATR + Pivot لتقليل الإشارات الكاذبة.</div>
        </div>
      </div>
    </div>

    <!-- Pivot والدعم/المقاومة -->
    <div class="card">
      <h3 class="section-title">الدعم والمقاومة (Pivot)</h3>
      <div class="grid">
        <div>R1 <div id="r1">—</div></div>
        <div>R2 <div id="r2">—</div></div>
        <div>R3 <div id="r3">—</div></div>
        <div>Pivot <div id="pivotP">—</div></div>
        <div>S1 <div id="s1">—</div></div>
        <div>S2 <div id="s2">—</div></div>
        <div>S3 <div id="s3">—</div></div>
      </div>
      <p class="muted" style="margin-top:8px">
        يُحسب الـ Pivot من آخر يوم مكتمل باستخدام (High/Low/Close) المستخرجة من بيانات 5 دقائق.
      </p>
    </div>

    <!-- البيانات الأخيرة -->
    <div class="card">
      <h3 class="section-title">البيانات الأخيرة</h3>
      <div style="overflow:auto">
        <table>
          <thead>
            <tr>
              <th>التاريخ</th>
              <th>الوقت (محلي)</th>
              <th>السعر</th>
              <th>الإشارة</th>
              <th>RSI</th>
              <th>MACD</th>
              <th>EMA F</th>
            </tr>
          </thead>
          <tbody id="rowsBody"></tbody>
        </table>
      </div>
    </div>

    <p class="muted" style="font-size:12px">* هذا المشروع لأغراض تعليمية، وليست نصيحة استثمارية.</p>
  </div>

  <script src="app.js"></script>
</body>
</html>
